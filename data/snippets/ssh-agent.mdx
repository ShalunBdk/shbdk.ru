---
heading: 'SSH-agent'
title: 'Управление ключами SSH с помощью агента'
date: '2024-11-21'
icon: 'Bash'
draft: false
summary: 'Управление ключами SSH с помощью агента'
tags: ['ssh', 'ssh-agent', 'linux']
---

Вводить парольную фразу каждый раз, когда используется *ssh* не очень удобно. Было бы намного проще ввести ее один раз при входе в систему, сохранить где-нибудь, а затем все время пользоваться. Такую задачу позволяет решить специальная программа — *ssh-agent*.

*ssh-agent* хранит секретные ключи и, когда нужно, пользуется ими. Программа (например, *ssh*), когда ей понадобится воспользоваться секретным ключом, не делает этого сама, а обращается к *ssh-agent* 'у, который в свою очередь уже *сам* пользуется известными только ему данными о секретных ключах. Таким образом, секретные ключи не разглашаются никому, даже программам принадлежащим самому пользователю.

Проверьте работу ssh-агента командой:

```bash
eval "$(ssh-agent -s)"
```

> [!tip]
> Для установки службы SSH-Agent в Windows, используйте PowerShell с повышенными привилегиями (запустите его от имени администратора), выполните следующую команду, чтобы установить службу SSH-Agent и настроить ее на автоматический запуск при входе в систему:

```powershell
Get-Service ssh-agent | Set-Service -StartupType Automatic -PassThru | Start-Service
```

Добавить ключи можно командой

```bash
ssh-add
```

Список известных агенту секретных ключей можно посмотреть той же командой *ssh-add* с ключом командной строки -l

```bash
ssh-add -l
```

**Опции командной строки программы *ssh-add***

- `-l` - Показать список отпечатков известных агенту ключей
- `-L` - Показать информацию обо всех открытых ключах, соответствующих секретным ключам, известным *ssh-add*
- `-d` - Удалить ключ у агента
- `-D` - Удалить все ключи у агента
- `-x` - Заблокировать агента паролем
- `-X` - Разблокировать агента
